<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warranty Certificate</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="certificate" id="certificate">
        <div class="top-banner">
            <div class="seal">
                <img src="img/logo.jpg" alt="Seal">
            </div>
            <div class="header-content">
                <p class="product-name"><b><big>Universal Electrical & Electronics</big></b><br>An ISO 9001:2015 Certified</p>
                <h1 class="warranty-title">WARRANTY</h1>
                <h2 class="certificate-title">Certificate</h2>
                <p class="description">At Universal Electricals and Electronics, we prioritize mining safety with our comprehensive solutions. Our commitment ensures a secure environment for your operations and peace of mind for your team.</p>
            </div>
        </div>

        <div class="details-section">
            <div class="details">
                <div class="detail-row">
                    <strong>Customer Name:</strong> <span id="customer-name"></span>
                </div>
                <div class="detail-row">
                    <strong>Invoice No:</strong> <span id="invoice-no"></span>
                </div>
                <div class="detail-row">
                    <strong>Model No.:</strong> <span id="model-no"></span>
                    <strong>Serial No.:</strong> <span id="serial-no"></span>
                </div>
                <div class="detail-row">
                    <strong>Purchase Date:</strong> <span id="purchase-date"></span>
                </div>
            </div>
        </div>
        
        <div class="signature-section">
            <div class="signature">
                <strong>Signature:</strong> <span id="signature"></span>
            </div>
            <div class="date">
                <strong>Date:</strong> <span id="current-date"></span>
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">
                <img src="img/Sample logo.jpg" alt="Sample Logo">
            </div>
            <div class="contact-info">
                <p>No. 15,16, 1st Floor, Girija Arcade, Abbigere Likshmipura Main Road, Bengaluru-560090</p>
                <p>Phone: 9876543210 | Email: eande.universal@gmail.com</p>
                <p>https://www.ueeindia.com/</p>
            </div>
        </div>
    </div>

<script>
    // Function to get URL parameters
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
    
    // Populate span elements from URL parameters
    document.getElementById('customer-name').innerText = getUrlParameter('customer') || 'Not Available';
    document.getElementById('invoice-no').innerText = getUrlParameter('invoice_number') || 'Not Available';
    document.getElementById('model-no').innerText = getUrlParameter('vehicle_model') || 'Not Available';
    document.getElementById('serial-no').innerText = getUrlParameter('serial') || 'Not Available';
    document.getElementById('purchase-date').innerText = getUrlParameter('invoice_date') || 'Not Available';
    document.getElementById('signature').innerText = getUrlParameter('customer') || 'Not Available';
    
    // Automatically fill today's date for signature
    document.getElementById('current-date').innerText = new Date().toLocaleDateString();

    // Generate PDF
    window.onload = function() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        html2canvas(document.getElementById('certificate')).then(canvas => {
            const imgData = canvas.toDataURL('image/png');
            const imgWidth = 190; // Adjust as necessary
            const pageHeight = doc.internal.pageSize.height;
            const imgHeight = (canvas.height * imgWidth) / canvas.width;
            let heightLeft = imgHeight;
            let position = 0;

            doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft >= 0) {
                position = heightLeft - imgHeight;
                doc.addPage();
                doc.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
            }

            // Save the generated PDF
            doc.save('warranty_certificate.pdf');
        });
    };
</script>
</body>
</html>
