<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>General Service Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #fff;
        }

        .container {
            max-width: 900px;
            margin: auto;
            border: 1px solid #000;
            padding: 20px;
        }

        h1, h2, h3, h4 {
            text-align: center;
        }

        .report-table, .checklist-table, .failed-parts-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .report-table td, .checklist-table th, .checklist-table td, .failed-parts-table th, .failed-parts-table td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }

        .checklist-table th {
            background-color: #f2f2f2;
        }

        textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .warranty-status {
            margin-top: 20px;
            text-align: left;
        }

        .for-user {
            margin-top: 20px;
            text-align: left;
        }

        /* Use flexbox to arrange the tables side by side */
        .table-wrapper {
            display: flex;
            /* justify-content: space-between; */
        }

        .report-table {
            width: 48%; /* Adjust width to allow space for both tables */
        }
        .checklist-table{
            width:52%;
        }

        .remarks-display {
    background-color: #f9f9f9; /* Light background for visibility */
    padding: 10px;
    border: 1px solid #ccc; /* Border for distinction */
    margin-bottom: 10px; /* Spacing between the display and textarea */
}

.remarks-display p {
    margin: 0; /* Remove default margin */
}
.navbar {
    display: flex;                    /* Use flexbox to align items in a row */
    justify-content: space-between;   /* Space between left and right items */
    align-items: center;              /* Vertically center items */
    padding: 10px;                    /* Add some padding */
}

.navbar-item.left {
    display: flex;                    /* Flexbox for the left item */
    align-items: center;              /* Vertically center the logo */
}

.logo {
    height: 50px;                     /* Set height for the company logo */
    margin-right: 300px;               /* Space between logo and company info */
}

.navbar-item.right {
    margin-left: auto;                /* Push this section to the right */
}

.company-info {
    display: flex;                    /* Flexbox for additional images */
}

.company-info img {
    height: 30px;                     /* Set a smaller height for additional images */
    margin-left: 10px;                /* Space between additional images */
}

    </style>
</head>
<body>
    <div class="container">
        <header class="navbar">
            <div class="navbar-item left">
                <img src="comapny log2.jpg" alt="Logo" class="logo">
                <div class="company-info">
                    <img src="img/mms.jpg" alt="Additional Image 1">
                    <img src="img/EGAC.png" alt="Additional Image 2">
                    <img src="img/IAF.png" alt="Additional Image 2">
                    <img src="img/NABCB.png" alt="Additional Image 2">
                </div>
            </div>
            
            <div class="navbar-item middle"></div>
            <div class="navbar-item right"></div>
        </header>
        <h3>GENERAL SERVICE REPORT</h3>

        <div class="table-wrapper">
            <table class="report-table">
                <tr>
                    <td><strong>Rep. No.:</strong></td>
                    <td><input type="text" id="repNo"  readonly></td>
                    <!-- <td><strong>DATE:</strong></td>
                    <td><input type="text" placeholder="DD/MM/YYYY"></td> -->
                </tr>
                <tr>
                    <td><strong>Customer Name:</strong></td>
                    <td><input type="text" id="customerName" placeholder="Customer Name"></td>
                </tr>
                <tr>
                    <td><strong>Area:</strong></td>
                    <td><input type="text" id="area" placeholder="Area"></td>
                </tr>
                <tr>
                    <td><strong>Project:</strong></td>
                    <td><input type="text" id="project" placeholder="Project"></td>
                </tr>
                <tr>
                    <td><strong>P.O. No. / Date:</strong></td>
                    <td><input type="text" id="poNo" placeholder="P.O. No."></td>
                </tr>
                <tr>
                    <td><strong>Equip Model:</strong></td>
                    <td><input type="text" id="equipModel" placeholder="Equip Model"></td>
                </tr>
                <tr>
                    <td><strong>Eqpt. Sl. No.:</strong></td>
                    <td><input type="text" id="eqptSlNo" placeholder="Eqpt. Sl. No."></td>
                </tr>
                    <td><strong>SYSTEM WORKING CONDITION:</strong></td>
                <tr>
                    <td><strong>Customer Complain Date:</strong></td>
                    <td><input type="text" id="complainDate" placeholder="Customer Complain Date"></td>
                </tr>
                <tr>
                    <td><strong>AT HMR:</strong></td>
                    <td><input type="text" id="atHmr1" placeholder="AT HMR"></td>
                </tr>
                <tr>
                    <td><strong>Customer Complain Closed Date:</strong></td>
                    <td><input type="text" id="complainClosedDate" placeholder="Customer Complain Closed Date"></td>
                </tr>
                <tr>
                    <td><strong>AT HMR:</strong></td>
                    <td><input type="text" id="atHmr2" placeholder="AT HMR"></td>
                </tr>
            </table>
    
            <table class="checklist-table">
                <tr>
                    <td><strong>DATE:</strong></td>
                    <td><input type="text" id="checklistDate" placeholder="DD/MM/YYYY"></td>
                </tr>
                <tr>
                    <td colspan="2"><h4>Component Status Checklist</h4></td>
                </tr>
                <tr>
                    <th>UEE Parts</th>
                    <th>Condition</th>
                        
                        <tr>
                            <td>1) Dcp Cylinder & Main Valve</td>
                            <td id="field15-value"></td>
                        </tr>
                        <tr>
                            <td>2) Nitrogen Cartridge (16-18 Cu.in)</td>
                            <td id="field16-value"></td>
                        </tr>
                        <tr>
                            <td>3) Automatic & Manual Actuator</td>
                            <td id="field17-value"></td>
                        </tr>
                        <tr>
                            <td>4) Manual Operate Actuator</td>
                            <td id="field18-value"></td>
                        </tr>
                        <tr>
                            <td>5) Main Valve Pneumatic Actuator</td>
                            <td id="field19-value"></td>
                        </tr>
                        <tr>
                            <td>6) Vent Check</td>
                            <td id="field20-value"></td>
                        </tr>
                        <tr>
                            <td>7) Non Return Valve</td>
                            <td id="field21-value"></td>
                        </tr>
                        <tr>
                            <td>8) Nozzle 1/2</td>
                            <td id="field22-value"></td>
                        </tr>
                        <tr>
                            <td>9) Nozzle 1/4</td>
                            <td id="field23-value"></td>
                        </tr>
                        <tr>
                            <td>10) Control Unit</td>
                            <td id="field24-value"></td>
                        </tr>
                        <tr>
                            <td>11) Main Harness</td>
                            <td id="field25-value"></td>
                        </tr>
                        <tr>
                            <td>12) Sp Adaptor</td>
                            <td id="field26-value"></td>
                        </tr>
                        <tr>
                            <td>13) Fire Sensor Wire per</td>
                            <td id="field27-value"></td>
                        </tr>
                        <tr>
                            <td>14) Hose Kit</td>
                            <td id="field28-value"></td>
                        </tr>
                        <tr>
                            <td>15) M5 Part</td>
                            <td id="field29-value"></td>
                        </tr>
                    </table>
                    
        </div>
    
        <h4>Failed Part Details:</h4>
        <table class="failed-parts-table">
            <tr>
                <th>SI No</th>
                <th>Uee Part No.</th>
                <th>Description</th>
                <th>Qty.</th>
                <th>Repair/Reject/To Be Replaced</th>
            </tr>
            <tr>
                <td>1</td>
                <td id="field32-value"></td>
                <td id="field36-value"></td>
                <td id="field40-value"></td>
                <td id="field44-value"></td>
            </tr>
            <tr>
                <td>2</td>
                <td id="field33-value"></td>
                <td id="field37-value"></td>
                <td id="field41-value"></td>
                <td id="field45-value"></td>
            </tr>
            <tr>
                <td>3</td>
                <td id="field34-value"></td>
                <td id="field38-value"></td>
                <td id="field42-value"></td>
                <td id="field46-value"></td>
            </tr>
            <tr>
                <td>4</td>
                <td id="field35-value"></td>
                <td id="field39-value"></td>
                <td id="field43-value"></td>
                <td id="field47-value"></td>
            </tr>
        </table>
        

    
<h4>SYMPTOMS:</h4>

<textarea id="symptoms" rows="4" placeholder="Enter symptoms here..." style="display: none;"></textarea>
<div class="remarks-display">

<p>
    <strong>• The automatic fire detection and suppression system has been successfully installed.</strong><br>
    <strong>• Continue regular inspections to keep everything in good condition and catch any future issues early.</strong><br>
    <strong>• Regular maintenance and testing are recommended to ensure continued optimal performance.</strong>
</p>
</div>

<script>
    // Set the value of the textarea
    document.getElementById('symptoms').value = `• The automatic fire detection and suppression system has been successfully installed.\n• Continue regular inspections to keep everything in good condition and catch any future issues early.\n• Regular maintenance and testing are recommended to ensure continued optimal performance.`;
</script>

        <div class="warranty-status">
            <strong>Status Of System:</strong>
            <label><input type="radio" name="warranty" value="under" checked> Under Warranty</label>
            <label><input type="radio" name="warranty" value="out"> Out of Warranty</label>
        </div>
    
        <div class="for-user">
            <p>For Uee: <span id="uee-value"></span></p>
            <p>For Customer: <span id="customer-value"></span></p>
        </div>
    







        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // Function to decode email
                function decodeEmail(encodedEmail) {
                    return decodeURIComponent(encodedEmail); // Decoding the URL-encoded email
                }
            
                // Function to get a cookie value by name and decode it
                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) {
                        return decodeURIComponent(parts.pop().split(';').shift()); // Decode the cookie value
                    }
                    return null; // Return null if the cookie is not found
                }
            
                // Retrieve the token from cookies
                const token = getCookie('token'); // Replace 'token' with the actual name of your token cookie
            
                const myHeaders = new Headers();
                myHeaders.append("Authorization", token); // Use token from cookies
                myHeaders.append("Content-Type", "application/json");
            
                // Prepare the raw data for the first request
                const raw = JSON.stringify({
                    "field1": getCookie('reportNumber') // Sending reportNumber as field1
                });
            
                // Define the request options for the first fetch call
                const requestOptions = {
                    method: "POST",
                    headers: myHeaders,
                    body: raw,
                    redirect: "follow"
                };
            
                // Make the first fetch request
                fetch("https://api2.itstrending.in/api/v1/profiles/search_multiple", requestOptions)
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok ' + response.statusText);
                        }
                        return response.json(); // Parse the response as JSON
                    })
                    .then((result) => {
                        const profileId = result.data.profile[1].profile_id; // Get the second profile's ID
                        console.log("profile_id:", profileId); // Log the profile_id to the console
            
                        // Retrieve and decode the email from cookies
                        const encodedEmail = getCookie('email'); // Get the encoded email from cookies
                        const email = decodeEmail(encodedEmail); // Decode the email
            
                        // Prepare request options for the second API call
                        const detailsRequestOptions = {
                            method: "POST",
                            headers: myHeaders,
                            body: JSON.stringify({
                                "profile_id": profileId,
                                "email": email // Adjust as needed
                            }),
                            redirect: "follow"
                        };
            
                        // Second API call to get profile details
                        fetch("https://api2.itstrending.in/api/v1/profiles/get_profile_details", detailsRequestOptions)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then(detailsResult => {
                                if (detailsResult && detailsResult.data && detailsResult.data.profile) {
                                    const profileDetails = detailsResult.data.profile; // Extract the profile details
                                    document.getElementById('repNo').value = profileDetails.field1 || '';
                                    document.getElementById('checklistDate').value = profileDetails.field8 || '';

                                    // Populate the form fields directly from profileDetails
                                    document.getElementById('customerName').value = profileDetails.field2 || '';
                                    document.getElementById('area').value = profileDetails.field3 || '';
                                    document.getElementById('project').value = profileDetails.field4 || '';
                                    document.getElementById('poNo').value = profileDetails.field5 || '';
                                    document.getElementById('equipModel').value = profileDetails.field6 || '';
                                    document.getElementById('eqptSlNo').value = profileDetails.field7 || '';
                                    document.getElementById('complainDate').value = profileDetails.field8 || '';
                                    document.getElementById('atHmr1').value = profileDetails.field9 || '';
                                    document.getElementById('complainClosedDate').value = profileDetails.field10 || '';
                                    document.getElementById('atHmr2').value = profileDetails.field11 || '';
            
                                  
                  // Populate the table values using profileDetails
                  document.getElementById('field15-value').innerText = profileDetails.field13 || 'N/A';
                        document.getElementById('field16-value').innerText = profileDetails.field14 || 'N/A';
                        document.getElementById('field17-value').innerText = profileDetails.field15 || 'N/A';
                        document.getElementById('field18-value').innerText = profileDetails.field17 || 'N/A';
                        document.getElementById('field19-value').innerText = profileDetails.field18 || 'N/A';
                        document.getElementById('field20-value').innerText = profileDetails.field20 || 'N/A';
                        document.getElementById('field21-value').innerText = profileDetails.field21 || 'N/A';
                        document.getElementById('field22-value').innerText = profileDetails.field22 || 'N/A';
                        document.getElementById('field23-value').innerText = profileDetails.field23 || 'N/A';
                        document.getElementById('field24-value').innerText = profileDetails.field24 || 'N/A';
                        document.getElementById('field25-value').innerText = profileDetails.field25 || 'N/A';
                        document.getElementById('field26-value').innerText = profileDetails.field27 || 'N/A';
                        document.getElementById('field27-value').innerText = profileDetails.field28 || 'N/A';
                        document.getElementById('field28-value').innerText = profileDetails.field29 || 'N/A';
                        document.getElementById('field29-value').innerText = profileDetails.field30 || 'N/A';
                         // Populate the second table values using profileDetails
                         document.getElementById('field32-value').innerText = profileDetails.field33 || 'N/A';
                        document.getElementById('field33-value').innerText = profileDetails.field34 || 'N/A';
                        document.getElementById('field34-value').innerText = profileDetails.field35 || 'N/A';
                        document.getElementById('field35-value').innerText = profileDetails.field36 || 'N/A';
                        document.getElementById('field36-value').innerText = profileDetails.field37 || 'N/A';
                        document.getElementById('field37-value').innerText = profileDetails.field38 || 'N/A';
                        document.getElementById('field38-value').innerText = profileDetails.field39 || 'N/A';
                        document.getElementById('field39-value').innerText = profileDetails.field40 || 'N/A';
                        document.getElementById('field40-value').innerText = profileDetails.field41 || 'N/A';
                        document.getElementById('field41-value').innerText = profileDetails.field42 || 'N/A';
                        document.getElementById('field42-value').innerText = profileDetails.field43 || 'N/A';
                        document.getElementById('field43-value').innerText = profileDetails.field44 || 'N/A';
                        document.getElementById('field44-value').innerText = profileDetails.field45 || 'N/A';
                        document.getElementById('field45-value').innerText = profileDetails.field46 || 'N/A';
                        document.getElementById('field46-value').innerText = profileDetails.field47 || 'N/A';
                        document.getElementById('field47-value').innerText = profileDetails.field48 || 'N/A';        
                        
                        
                        // Get the value of 'field31' and 'field32' for Uee and Customer
                                    document.getElementById('uee-value').textContent = profileDetails.field31 || 'No value set';
                                    document.getElementById('customer-value').textContent = profileDetails.field32 || 'No value set';
            
                                } else {
                                    console.error("No profile details found in the response.");
                                }
                            })
                            .catch(error => console.error('Fetch error for details:', error)); // Log any errors for the second fetch
                    })
                    .catch((error) => console.error('Fetch error:', error)); // Log any errors for the first fetch
            });
            </script>
            
    
    
</body>
</html>